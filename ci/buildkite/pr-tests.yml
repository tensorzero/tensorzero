steps:
  - label: "Build Gateway Container"
    command: bash ./ci/buildkite/build-gateway-container.sh
    key: "build-gateway-container"
    artifact_paths:
      - gateway-container.tar

  - label: "Build UI Container"
    command: bash ./ci/buildkite/build-ui-container.sh
    key: "build-ui-container"
    artifact_paths:
      - ui-container.tar

  - label: ":rust: Rust Unit Tests"
    command: bash ./ci/buildkite/rust-unit-tests.sh
    plugins:
      - docker:
          image: "rust"
          mount-buildkite-agent: true

  - label: ":node: Node.js Tests"
    # command: bash ./ci/buildkite/node-unit-tests.sh
    command: bash ./ci/buildkite/node-unit-tests.sh
    depends_on: "build-gateway-container"
