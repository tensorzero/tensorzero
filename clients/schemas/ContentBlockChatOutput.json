{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "ContentBlockChatOutput",
  "description": "Defines the types of content block that can come from a `chat` function",
  "oneOf": [
    {
      "description": "InputMessages are validated against the input schema of the Function\nand then templated and transformed into RequestMessages for a particular Variant.\nThey might contain tool calls or tool results along with text.\nThe abstraction we use to represent this is ContentBlock, which is a union of Text, ToolCall, and ToolResult.\nContentBlocks are collected into RequestMessages.\nThese RequestMessages are collected into a ModelInferenceRequest,\nwhich should contain all information needed by a ModelProvider to perform the\ninference that is called for.",
      "type": "object",
      "properties": {
        "text": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "const": "text"
        }
      },
      "additionalProperties": false,
      "required": [
        "type",
        "text"
      ]
    },
    {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "tool_call"
        }
      },
      "$ref": "#/$defs/InferenceResponseToolCall",
      "required": [
        "type"
      ]
    },
    {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "thought"
        }
      },
      "$ref": "#/$defs/Thought",
      "required": [
        "type"
      ]
    },
    {
      "type": "object",
      "properties": {
        "data": true,
        "model_provider_name": {
          "type": [
            "string",
            "null"
          ]
        },
        "type": {
          "type": "string",
          "const": "unknown"
        }
      },
      "required": [
        "type",
        "data"
      ]
    }
  ],
  "$defs": {
    "InferenceResponseToolCall": {
      "description": "An InferenceResponseToolCall is a request by a model to call a Tool\nin the form that we return to the client / ClickHouse",
      "type": "object",
      "properties": {
        "id": {
          "description": "A Tool Call ID to match up with tool call responses. See #4058.",
          "type": "string"
        },
        "raw_name": {
          "description": "The name of the tool to call, as generated by the model.",
          "type": "string"
        },
        "raw_arguments": {
          "description": "The raw arguments JSON string of the tool to call, as generated by the model.",
          "type": "string"
        },
        "name": {
          "description": "The name of the tool to call, validated against tool configs. If not present, it means the tool call was invalid.",
          "type": [
            "string",
            "null"
          ]
        },
        "arguments": {
          "description": "The arguments of the tool to call, validated against tool configs. If not present, it means the tool call arguments were invalid."
        }
      },
      "required": [
        "id",
        "raw_name",
        "raw_arguments"
      ]
    },
    "ThoughtSummaryBlock": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "text": {
              "type": "string"
            },
            "type": {
              "type": "string",
              "const": "summary_text"
            }
          },
          "required": [
            "type",
            "text"
          ]
        }
      ]
    },
    "Thought": {
      "description": "Struct that represents a model's reasoning",
      "type": "object",
      "properties": {
        "text": {
          "type": [
            "string",
            "null"
          ]
        },
        "signature": {
          "description": "An optional signature - currently, this is only used with Anthropic,\nand is ignored by other providers.",
          "type": [
            "string",
            "null"
          ]
        },
        "summary": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "$ref": "#/$defs/ThoughtSummaryBlock"
          }
        },
        "_internal_provider_type": {
          "description": "When set, this 'Thought' block will only be used for providers\nmatching this type (e.g. `anthropic`). Other providers will emit\na warning and discard the block.",
          "type": [
            "string",
            "null"
          ]
        }
      }
    }
  }
}