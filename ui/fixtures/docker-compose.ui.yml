services:
  ui:
    image: tensorzero/ui:${TENSORZERO_UI_TAG:-latest}
    build:
      context: ../..
      dockerfile: ui/Dockerfile
    environment:
      - TENSORZERO_GATEWAY_URL=${TENSORZERO_GATEWAY_URL:-http://gateway:3000}
      - TENSORZERO_CLICKHOUSE_URL=http://chuser:chpassword@clickhouse:8123/tensorzero_ui_fixtures
      - TENSORZERO_POSTGRES_URL=postgres://postgres:postgres@postgres:5432/tensorzero_ui_fixtures
      - VITE_TENSORZERO_FORCE_CACHE_ON
      # Allow overriding for mock mode (SFT jobs and batch inference)
      - TENSORZERO_INTERNAL_MOCK_PROVIDER_API
    env_file:
      - .env
    ports:
      - "4000:4000"
    restart: unless-stopped
    extra_hosts:
      - "host.docker.internal:host-gateway"
